<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab7 API Tester - IntelliJ Spring Boot</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .endpoint-card { transition: transform 0.2s; }
        .endpoint-card:hover { transform: translateY(-2px); }
        .response-area { font-family: 'Courier New', monospace; font-size: 0.9em; }
        .status-2xx { color: #198754; }
        .status-4xx { color: #dc3545; }
        .status-5xx { color: #fd7e14; }
    </style>
</head>
<body class="bg-light">
<div class="container py-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex align-items-center mb-4">
                <i class="fas fa-boxes fa-2x text-primary me-3"></i>
                <div>
                    <h1 class="h2 mb-0">Lab7 API</h1>
                    <p class="text-muted">Spring Boot REST API Tester</p>
                </div>
            </div>

            <!-- Server Status -->
            <div class="alert alert-info d-flex align-items-center">
                <i class="fas fa-server me-2"></i>
                <div>
                    <strong>Base URL:</strong> <code id="baseUrl">http://localhost:8080/api/products</code>
                    <span class="badge bg-success ms-2" id="statusBadge">Connected</span>
                </div>
            </div>

            <!-- GET All Products -->
            <div class="card endpoint-card mb-4">
                <div class="card-header bg-success text-white">
                    <i class="fas fa-list me-2"></i>
                    GET All Products
                </div>
                <div class="card-body">
                    <p class="card-text">Retrieve all products from the inventory</p>
                    <button class="btn btn-success" onclick="getAllProducts()">
                        <i class="fas fa-play me-1"></i> Execute GET
                    </button>
                    <div class="mt-3">
                        <label class="form-label">Response:</label>
                        <pre id="getAllResponse" class="response-area bg-dark text-light p-3 rounded" style="min-height: 100px;"></pre>
                    </div>
                </div>
            </div>

            <!-- GET Product by ID -->
            <div class="card endpoint-card mb-4">
                <div class="card-header bg-primary text-white">
                    <i class="fas fa-search me-2"></i>
                    GET Product by ID
                </div>
                <div class="card-body">
                    <div class="row g-3 align-items-end">
                        <div class="col-md-4">
                            <label class="form-label">Product ID:</label>
                            <label for="productId"></label><input type="number" class="form-control" id="productId" value="1" min="1">
                        </div>
                        <div class="col-md-8">
                            <button class="btn btn-primary" onclick="getProductById()">
                                <i class="fas fa-play me-1"></i> Execute GET
                            </button>
                        </div>
                    </div>
                    <div class="mt-3">
                        <label class="form-label">Response:</label>
                        <pre id="getByIdResponse" class="response-area bg-dark text-light p-3 rounded" style="min-height: 100px;"></pre>
                    </div>
                </div>
            </div>

            <!-- POST Create Product -->
            <div class="card endpoint-card mb-4">
                <div class="card-header bg-warning text-dark">
                    <i class="fas fa-plus me-2"></i>
                    POST Create Product
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-5">
                            <label class="form-label">Product Name:</label>
                            <label for="productName"></label><input type="text" class="form-control" id="productName" value="New Tablet">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Price:</label>
                            <label for="productPrice"></label><input type="number" class="form-control" id="productPrice" value="299.99" step="0.01">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">&nbsp;</label>
                            <button class="btn btn-warning w-100" onclick="createProduct()">
                                <i class="fas fa-play me-1"></i> Execute POST
                            </button>
                        </div>
                    </div>
                    <div class="mt-3">
                        <label class="form-label">Response:</label>
                        <pre id="createResponse" class="response-area bg-dark text-light p-3 rounded" style="min-height: 100px;"></pre>
                    </div>
                </div>
            </div>

            <!-- PUT Update Product -->
            <div class="card endpoint-card mb-4">
                <div class="card-header bg-info text-white">
                    <i class="fas fa-edit me-2"></i>
                    PUT Update Product
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-2">
                            <label class="form-label">Product ID:</label>
                            <label for="updateId"></label><input type="number" class="form-control" id="updateId" value="1" min="1">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">New Name:</label>
                            <label for="updateName"></label><input type="text" class="form-control" id="updateName" value="Updated Laptop Pro">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">New Price:</label>
                            <label for="updatePrice"></label><input type="number" class="form-control" id="updatePrice" value="1399.99" step="0.01">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">&nbsp;</label>
                            <button class="btn btn-info w-100" onclick="updateProduct()">
                                <i class="fas fa-play me-1"></i> Execute PUT
                            </button>
                        </div>
                    </div>
                    <div class="mt-3">
                        <label class="form-label">Response:</label>
                        <pre id="updateResponse" class="response-area bg-dark text-light p-3 rounded" style="min-height: 100px;"></pre>
                    </div>
                </div>
            </div>

            <!-- DELETE Product -->
            <div class="card endpoint-card mb-4">
                <div class="card-header bg-danger text-white">
                    <i class="fas fa-trash me-2"></i>
                    DELETE Product
                </div>
                <div class="card-body">
                    <div class="row g-3 align-items-end">
                        <div class="col-md-4">
                            <label class="form-label">Product ID to Delete:</label>
                            <label for="deleteId"></label><input type="number" class="form-control" id="deleteId" value="1" min="1">
                        </div>
                        <div class="col-md-8">
                            <button class="btn btn-danger" onclick="deleteProduct()">
                                <i class="fas fa-play me-1"></i> Execute DELETE
                            </button>
                        </div>
                    </div>
                    <div class="mt-3">
                        <label class="form-label">Response:</label>
                        <pre id="deleteResponse" class="response-area bg-dark text-light p-3 rounded" style="min-height: 100px;"></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const baseUrl = 'http://localhost:8080/api/products';

    function formatResponse(status, data) {
        const statusClass = status >= 200 && status < 300 ? 'status-2xx' :
            status >= 400 && status < 500 ? 'status-4xx' : 'status-5xx';
        return `<span class="${statusClass}">Status: ${status}</span>\n${JSON.stringify(data, null, 2)}`;
    }

    async function getAllProducts() {
        try {
            const response = await fetch(baseUrl);
            const data = await response.json();
            document.getElementById('getAllResponse').innerHTML = formatResponse(response.status, data);
        } catch (error) {
            document.getElementById('getAllResponse').innerHTML = `Error: ${error.message}`;
        }
    }

    async function getProductById() {
        const id = document.getElementById('productId').value;
        try {
            const response = await fetch(`${baseUrl}/${id}`);
            if (response.ok) {
                const data = await response.json();
                document.getElementById('getByIdResponse').innerHTML = formatResponse(response.status, data);
            } else {
                document.getElementById('getByIdResponse').innerHTML = formatResponse(response.status, { error: 'Product not found' });
            }
        } catch (error) {
            document.getElementById('getByIdResponse').innerHTML = `Error: ${error.message}`;
        }
    }

    async function createProduct() {
        const product = {
            name: document.getElementById('productName').value,
            price: parseFloat(document.getElementById('productPrice').value)
        };

        try {
            const response = await fetch(baseUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(product)
            });
            const data = await response.json();
            document.getElementById('createResponse').innerHTML = formatResponse(response.status, data);

            // Refresh the products list
            getAllProducts();
        } catch (error) {
            document.getElementById('createResponse').innerHTML = `Error: ${error.message}`;
        }
    }

    async function updateProduct() {
        const id = document.getElementById('updateId').value;
        const product = {
            name: document.getElementById('updateName').value,
            price: parseFloat(document.getElementById('updatePrice').value)
        };

        try {
            const response = await fetch(`${baseUrl}/${id}`, {
            method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(product)
        });
        if (response.ok) {
            const data = await response.json();
            document.getElementById('updateResponse').innerHTML = formatResponse(response.status, data);
        } else {
            document.getElementById('updateResponse').innerHTML = formatResponse(response.status, { error: 'Product not found' });
        }

        // Refresh the products list
        getAllProducts();
    } catch (error) {
        document.getElementById('updateResponse').innerHTML = `Error: ${error.message}`;
    }
    }

    async function deleteProduct() {
        const id = document.getElementById('deleteId').value;
        try {
            const response = await fetch(`${baseUrl}/${id}`, { method: 'DELETE' });
            const result = response.ok ? { message: 'Product deleted successfully' } : { error: 'Product not found' };
            document.getElementById('deleteResponse').innerHTML = formatResponse(response.status, result);

            // Refresh the products list
            getAllProducts();
        } catch (error) {
            document.getElementById('deleteResponse').innerHTML = `Error: ${error.message}`;
        }
    }

    // Initialize by loading all products
    window.onload = function() {
        getAllProducts();
        // Test server connection
        fetch(baseUrl)
            .then(response => {
                const badge = document.getElementById('statusBadge');
                if (response.ok) {
                    badge.className = 'badge bg-success';
                    badge.textContent = 'Connected';
                } else {
                    badge.className = 'badge bg-warning';
                    badge.textContent = 'Server Error';
                }
            })
            .catch(() => {
                const badge = document.getElementById('statusBadge');
                badge.className = 'badge bg-danger';
                badge.textContent = 'Disconnected';
            });
    };
</script>
</body>
</html>